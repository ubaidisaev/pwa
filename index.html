<!DOCTYPE html>
<html lang="en-US" dir="ltr">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="converter.css">
  <meta name="theme-color" content="#1f1f28" />

  <link rel="apple-touch-icon" sizes="72x72" href="https://ubaidisaev.github.io/pwa/icons/icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="https://ubaidisaev.github.io/pwa/icons/icon-96x96.png">
  <link rel="apple-touch-icon" sizes="114x114" href="https://ubaidisaev.github.io/pwa/icons/icon-128x128.png">
  <link rel="apple-touch-icon" sizes="120x120" href="https://ubaidisaev.github.io/pwa/icons/icon-128x128.png">
  <link rel="apple-touch-icon" sizes="144x144" href="https://ubaidisaev.github.io/pwa/icons/icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="https://ubaidisaev.github.io/pwa/icons/icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://ubaidisaev.github.io/pwa/icons/icon-192x192.png">
  <script src="https://www.youtube.com/iframe_api"></script>

  <title>Arabic Language</title>


  <style>
    body {
      position: relative;
      display: flex;
      flex-direction: column;
      background-color: #1f1f28;
    }

    .subtitles {
      display: flex;
      flex-direction: column;
      flex: 1;
      background-color: #1f1f28;
      color: #fff;
    }

    .lang {
      padding-top: 15px;
      flex: 1;
    }

    .line {
      background-color: #ffffff70;
      width: 100%;
      height: 2px;
      margin: 10px 0;
    }

    .icon {
      width: 30px;
      fill: #fff;
    }

    .controls {
      position: absolute;
      width: 70px;
      height: 70px;
      border-radius: 70px;
      bottom: 0;
      left: 0;
      right: 0;
      margin: 5px auto;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: rgba(54, 54, 54, .3);
    }

    /* player */
    .ytp-chrome-top.ytp-show-cards-title {
        display: none;
    } 

    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .loading:after {
      content: '';
      display: block;
      width: 100px;
      height: 100px;
      background-image: url("data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMNyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAxMDAgMTAwIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KIDxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0zMS42LDMuNUM1LjksMTMuNi02LjYsNDIuNywzLjUsNjguNGMxMC4xLDI1LjcsMzkuMiwzOC4zLDY0LjksMjguMWwtMy4xLTcuOWMtMjEuMyw4LjQtNDUuNC0yLTUzLjgtMjMuMwogIGMtOC40LTIxLjMsMi00NS40LDIzLjMtNTMuOEwzMS42LDMuNXoiPgogICAgICA8YW5pbWF0ZVRyYW5zZm9ybSBhdHRyaWJ1dGVOYW1lPSJ0cmFuc2Zvcm0iIGF0dHJpYnV0ZVR5cGU9IlhNTCIgdHlwZT0icm90YXRlIiBkdXI9IjJzIiBmcm9tPSIwIDUwIDUwIiB0bz0iMzYwIDUwIDUwIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSI+PC9hbmltYXRlVHJhbnNmb3JtPgogIDwvcGF0aD4KIDxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik00Mi4zLDM5LjZjNS43LTQuMywxMy45LTMuMSwxOC4xLDIuN2M0LjMsNS43LDMuMSwxMy45LTIuNywxOC4xbDQuMSw1LjVjOC44LTYuNSwxMC42LTE5LDQuMS0yNy43CiAgYy02LjUtOC44LTE5LTEwLjYtMjcuNy00LjFMNDIuMywzOS42eiI+CiAgICAgIDxhbmltYXRlVHJhbnNmb3JtIGF0dHJpYnV0ZU5hbWU9InRyYW5zZm9ybSIgYXR0cmlidXRlVHlwZT0iWE1MIiB0eXBlPSJyb3RhdGUiIGR1cj0iMXMiIGZyb209IjAgNTAgNTAiIHRvPSItMzYwIDUwIDUwIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSI+PC9hbmltYXRlVHJhbnNmb3JtPgogIDwvcGF0aD4KIDxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik04MiwzNS43Qzc0LjEsMTgsNTMuNCwxMC4xLDM1LjcsMThTMTAuMSw0Ni42LDE4LDY0LjNsNy42LTMuNGMtNi0xMy41LDAtMjkuMywxMy41LTM1LjNzMjkuMywwLDM1LjMsMTMuNQogIEw4MiwzNS43eiI+CiAgICAgIDxhbmltYXRlVHJhbnNmb3JtIGF0dHJpYnV0ZU5hbWU9InRyYW5zZm9ybSIgYXR0cmlidXRlVHlwZT0iWE1MIiB0eXBlPSJyb3RhdGUiIGR1cj0iMnMiIGZyb209IjAgNTAgNTAiIHRvPSIzNjAgNTAgNTAiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIj48L2FuaW1hdGVUcmFuc2Zvcm0+CiAgPC9wYXRoPgo8L3N2Zz4=");
      background-repeat: no-repeat;
      background-position: center;
      background-size: 50px;
      z-index: 10;
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      margin: auto;
    }

    .loading:before {
      content: '';
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
      background-color: #1f1f28;
      z-index: 5;
    }
  </style>
</head>

<body class="loading">


  <div id="player"></div>
  <!-- <iframe width="100%" height="250" src="https://www.youtube.com/embed/ZVpCiHNZ7hQ?si=5iV-2PVQ3ojtm9Tx"
    title="YouTube video player" frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
    referrerpolicy="strict-origin-when-cross-origin"></iframe> -->

  <div class="subtitles" id="app">

  </div>


  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script src="data.js"></script>

  <script>



    const app = Vue.createApp({
      setup() {
        const message = Vue.ref('Hello vue!')
        return {
          message,
        }
      },
      data() {
        return {
          data: data,
          currentScreen: null,
          playerState: 0,
          loading: true,
          // currentTime,
        }
      },
      mounted() {
        const slef = this;
        const onYouTubeIframeAPIReady = async () => {
          await new Promise(r => setTimeout(r, 1000));
          this.player = new YT.Player('player', {
            height: '250',
            width: '100%',
            videoId: 'ZVpCiHNZ7hQ',
            playerVars: {
              playersinline: 1,
              autoplay: 0,
              controls: 1,
            },
            events: {
              'onReady': this.onPlayerReady,
              onStateChange: this.onPlayerStateChange,
            }
          });
        };
        onYouTubeIframeAPIReady();

      },
      methods: {
        onPlayerStateChange(event) {
          if (event.data == YT.PlayerState.PLAYING) {
            this.playerState = 1;
          } else if (event.data == YT.PlayerState.PAUSED) {
            this.playerState = 0;
          }
          // Add additional states as needed
        },
        onPlayerReady(event) {
          document.body.classList.remove('loading');
          // console.log(this.player.g.querySelector('.ytp-chrome-top.ytp-show-cards-title'))
          try {
            const root = this.player.g.contentDocument || this.player.g.contentWindow.document;
            const rootElement = iframeDocument.documentElement;
            console.log('rootElement', rootElement)
          } catch(err){console.log('iframe error', err)}
          // Start listening for playback time updates every second
          let oldItem = {};
          setInterval(() => {
            var currentTime = this.player.getCurrentTime();
            let item = data.find((item) => (item.offset + item.duration) > currentTime);
            if (JSON.stringify(item) === JSON.stringify(oldItem)) {
              return;
            } else {
              console.log('item', item, currentTime);
              this.currentScreen = item;
              oldItem = item;
            }


          }, 1000);
        }
      },
      template: `
      <div class='main' v-if="!loading">
      <div class="lang" v-if="currentScreen">
      {{currentScreen.text}}
    </div>
    <div class="line"></div>
    <div class="lang">
      Let's go to learn arabic language
    </div>
       <div class="controls">

      <svg v-if="playerState === 1" class="icon" viewBox="0 0 88 88" xmlns="http://www.w3.org/2000/svg"><g transform="translate(20 16)" fill="currentColor" fill-rule="evenodd"><rect width="16" height="56" rx="2"></rect><rect x="32" width="16" height="56" rx="2"></rect></g></svg>
    
      <svg v-else class="icon" viewBox="0 0 88 88" xmlns="http://www.w3.org/2000/svg"><path d="M68.255 40.695 28.957 12.83C26.087 10.795 22 12.736 22 16.133v55.733c0 3.397 4.087 5.34 6.957 3.305l39.298-27.867c2.327-1.65 2.327-4.96 0-6.609" fill="currentColor" fill-rule="evenodd"></path></svg>
    </div>
    </div>
      
  `,
    });



    app.mount('#app')



  </script>
</body>

</html>